// sanservices_absence - Last Update: Friday, December 19th, 2014, 9:41:57 AM CST
function fx_nuevo(){v_ac="nuevo",$("#modal_eventos_titulo").text("Nuevo Evento"),$("[name='no']").focus()}function fx_eliminar(a){v_ac="eliminar",v_id=a.closest("tr").attr("id");var b=a.closest("tr").children(),c="Â¿Estas seguro de Eliminar a <h4 style = 'display:inline;'><span class = 'label label-danger'>"+b[0].innerHTML+"</span></h4>?";$("#msj_eliminar").html(c)}function fx_editar(a){v_ac="editar",v_id=a.closest("tr").attr("id");var b=a.closest("tr").children();$("#modal_eventos_titulo").text("Editar Evento"),$("input[name='no']").val(b[0].innerHTML),$("input[name='fi']").val(b[1].innerHTML),$("input[name='ff']").val(b[2].innerHTML),$("[name='inf']").val(b[3].innerHTML.split("</span> ")[1]),$(".btn.btn-default.iconpicker > i").removeClass().addClass($(b[3].innerHTML).attr("class"))}function fx_data(){var a={};if("nuevo"==v_ac||"editar"==v_ac){var b=$('input[name="no"]').val(),c=$('input[name="fi"]').val(),d=$('input[name="ff"]').val(),e="<span class = \\'"+$(".btn.btn-default.iconpicker > i").attr("class")+"\\' style = \\'font-size: 18px;\\'></span> "+$("textarea").val().split("\n").join("<br>");a={accion:v_ac,no:b,fi:c,ff:d,inf:e}}return("editar"==v_ac||"eliminar"==v_ac)&&(a.id=v_id,a.accion=v_ac),a}require(["/assets/js/app.js"],function(){$(document).ready(function(){function a(a){for(v in a)""==$("[name='"+v+"']").val()&&$("[name='"+v+"']").parent().addClass("has-error has-feedback").append('<span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>')}$("#modal_nuevo").on("hidden.bs.modal",function(){$("#form_eventos")[0].reset(),v_ac="",v_id=0,$(".has-error").removeClass("has-error").removeClass("has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback").remove()}),$(".accion").click(function(){var b=fx_data();a(b),"undefined"==typeof $(".has-error").get(0)&&$.ajax({url:"/mant_eventos",type:"POST",data:b,success:function(a){if("string"==typeof a)return $.ajax(this);if(a.affectedRows){if("editar"==b.accion){var c=$("#"+b.id).closest("tr").children();c[0].innerHTML=b.no,c[1].innerHTML=b.fi,c[2].innerHTML=b.ff,c[3].innerHTML=b.inf.replace(/\\/g,"")}else if("eliminar"==b.accion)$("#"+b.id).remove();else if("nuevo"==b.accion){var d='<td><a onclick="fx_editar($(this))" class="btn btn-primary" data-toggle="modal" data-target="#modal_nuevo"><span class="glyphicon glyphicon-edit"></span> Editar</a></td>',e='<td><a onclick="fx_eliminar($(this))" class="lg btn btn-danger" data-toggle="modal" data-target="#confirmDelete"><span class="glyphicon glyphicon-trash"></span> Eliminar</a></td>',f=t.fnAddData([b.no,b.fi,b.ff,b.inf.replace(/\\/g,""),d,e]),g=t.fnGetNodes(f);$(g).attr("id",a.insertId)}$(".modal").modal("hide")}}})}),$("#startDate").datepicker({defaultDate:"+1w",dateFormat:"mm-dd-yy",changeMonth:!0,changeYear:!0,onSelect:function(a){$("#endDate").datepicker("option","minDate",a),$(this).parent().removeClass("has-error has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback",$(this).parent()).remove()}}),$("#endDate").datepicker({defaultDate:"+1w",dateFormat:"mm-dd-yy",changeMonth:!0,changeYear:!0,onSelect:function(a){$("#startDate").datepicker("option","maxDate",a),$(this).parent().removeClass("has-error has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback",$(this).parent()).remove()}})})});var v_ac="",v_id=0;