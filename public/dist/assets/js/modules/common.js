// sanservices_absence - Last Update: Monday, December 15th, 2014, 4:36:44 PM CST
function alerta(a){var b=a.parent();a.val()?b.hasClass("has-error")&&(b.removeClass("has-error"),$(".glyphicon.glyphicon-remove.form-control-feedback",b).remove()):b.hasClass("has-error")||(b.addClass("has-error has-feedback"),"email"!=a.attr("type")&&b.append('<span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true"></span>'))}define("common",function(){$(function(){console.log("ready!"),Date.prototype.MDY=function(a){var b=String(this.getDate()),c=String(this.getMonth()+1),d=String(this.getFullYear());return b=1==b.length?"0"+b:b,c=1==c.length?"0"+c:c,d=1==d.length?"0"+d:d,[c,b,d].join(a||"/")},$(window).on("resize",function(){$(document).width()-$("#sidebar-wrapper").width()-$("table").width()<24?$("table").parent().hasClass("t-responsive")||$("table").parent().wrapInner('<div class="t-responsive"></div>'):$("table").parent().hasClass("t-responsive")&&$("table").parent().removeClass("t-responsive")}),$("td div.flo").each(function(){var a=$(this).html().split(","),b="";for(var c in a){var d=["Dom","Lun","Mar","Mie","Jue","Vie","Sab"];a[c]=new Date(a[c].trim().split("-").join("/")),b+=d[a[c].getDay()]+"	"+a[c].MDY("-")+",\n"}console.log(b),$(this).html(b)}),$('li a[href="/'+location.pathname.split("/")[1]+'"]').parent().addClass("active"),$(".table").hasClass("noDataTables")||(t=$(".table").dataTable($(".table").hasClass("bSort")?{bSort:!1,dom:'T<"clear">lfrtip',oLanguage:{sSearch:"Buscar:",sLengthMenu:"Mostrar _MENU_ registros",sProcessing:"Procesando...",sInfo:"Mostrando _START_ - _END_ de _TOTAL_ registros",sInfoEmpty:"Mostrando 0 - 0 de 0 registros",sInfoFiltered:"(filtrado de _MAX_ registros)",sZeroRecords:"No hay Resultados"}}:{dom:'T<"clear">lfrtip',oLanguage:{sSearch:"Buscar:",sLengthMenu:"Mostrar _MENU_ registros",sProcessing:"Procesando...",sInfo:"Mostrando _START_ - _END_ de _TOTAL_ registros",sInfoEmpty:"Mostrando 0 - 0 de 0 registros",sInfoFiltered:"(filtrado de _MAX_ registros)",sZeroRecords:"No hay Resultados"}}),$(".dataTables_wrapper").prepend("<br/>"))}),$(function(){function a(a){var b=a.getUTCMonth()+1,c=a.getUTCDate(),d=a.getUTCFullYear();return[b,c,d].join("-")}function b(a){a.stopPropagation(),a.preventDefault();var b=a.dataTransfer.files;document.getElementById("archivo").files=b}function c(b){var c=[],d=[];f=b[0];var e=String(f.name.substr(f.name.lastIndexOf("."),f.name.length));if(".xls"==e||".xlsx"==e){c.push('<div class="icon-excel icon-excel-',e.substring(1,5),'"> <div style="position: relative;top: 100%;text-align: center;">',escape(f.name),"</div> </div>"),$("#drop_zone").css({"text-align":"inherit",font:"inherit",color:"inherit"}),document.getElementById("drop_zone").innerHTML="<ul>"+c.join("")+"</ul>",d=[],console.log(f);var g=new FileReader;g.onload=function(b){var c=b.target.result,d=".xls"==e?XLS.read(c,{type:"binary"}):XLSX.read(c,{type:"binary"}),f=d.SheetNames,g=d.Sheets[f[0]],c=".xls"==e?XLS.utils.sheet_to_json(g,{header:1}):XLSX.utils.sheet_to_json(g,{header:1}),h=c.length,i=c[0].length;sql="INSERT IGNORE INTO %tabla %campos VALUES \n",console.log(c),console.log(h),console.log(i);for(var j=0;h>j;j++)if(sql+="(",void 0!=c[j]){if(isNaN(c[j])){var k=new Date(Date.parse(c[j]));c[j]="Invalid Date"!=k?"STR_TO_DATE('"+a(k)+"', '%m-%d-%Y')":"'"+c[j]+"'"}sql+=c[j],sql+=",%idusuario",sql+="),\n"}sql=sql.slice(0,sql.length-2)+";",console.log(sql)},g.readAsBinaryString(f)}else d.push("<li><strong>",escape(f.name),'</strong> <span class = "red">*Tiene una extensión incorrecta!</span></li>'),$("#drop_zone").removeClass(),$("#drop_zone").addClass("#drop_zone"),document.getElementById("archivo").value="";document.getElementById("list").innerHTML="<ul>"+d.join("")+"</ul>"}function d(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"}bind_events(),console.log("[Common]: Initiated");var e=new Date;$(".datepicker").datepicker({dateFormat:"mm-dd-yy",minDate:new Date(e.getFullYear(),e.getMonth(),e.getDate()+1),beforeShowDay:$.datepicker.noWeekends,onSelect:function(){$(this).parent().removeClass("has-error has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback",$(this).parent()).remove()}}).val();var g=$.fn.modal.Constructor.prototype.enforceFocus;if($(".modal").has("input").on("show.bs.modal",function(){$.fn.modal.Constructor.prototype.enforceFocus=function(){}}),$(".modal").has("input").on("hidden.bs.modal",function(){$.fn.modal.Constructor.prototype.enforceFocus=g}),$(".modal").on("hidden.bs.modal",function(){$("form").each(function(){this.reset()}),$(".has-error").removeClass("has-error").removeClass("has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback").remove()}),$(".datepicker-normal").datepicker({dateFormat:"mm-dd-yy",monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],onSelect:function(){$(this).parent().removeClass("has-error has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback",$(this).parent()).remove()}}).val(),$(".datepicker-bday").datepicker({changeMonth:!0,changeYear:!0,yearRange:"1935:"+(new Date).getFullYear(),dateFormat:"mm-dd-yy",monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],maxDate:new Date(e.getFullYear()-16,e.getMonth(),e.getDate()),onSelect:function(){$(this).parent().removeClass("has-error has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback",$(this).parent()).remove()}}),$(".datepicker-trab").datepicker({changeMonth:!0,changeYear:!0,yearRange:"1945:"+(new Date).getFullYear(),dateFormat:"mm-dd-yy",monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],minDate:new Date("2005",e.getMonth(),e.getDate()),maxDate:e,onSelect:function(){$(this).parent().removeClass("has-error has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback",$(this).parent()).remove()}}),$(".datepicker-year").datepicker({changeMonth:!0,changeYear:!0,yearRange:"1945:"+(new Date).getFullYear(),dateFormat:"mm-dd-yy",monthNamesShort:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],maxDate:e,onSelect:function(){$(this).parent().removeClass("has-error has-feedback"),$(".glyphicon.glyphicon-remove.form-control-feedback",$(this).parent()).remove()}}),$("#menu-toggle").click(function(a){$("#wrapper").toggleClass("toggled"),a.preventDefault()}),$(".switch").bootstrapSwitch(),"undefined"!=typeof availableTags&&$("#buscar").autocomplete({source:availableTags}),null!=document.getElementById("drop_zone")){$("document").ready(function(){$("#archivo").change(function(){c($(this)[0].files),""==document.getElementById("archivo").value&&($("#drop_zone").html("Arrastre AQUI un Archivo de EXCEL .XLS ó .XLSX"),$("#drop_zone").attr("style",""))}),$("#cancelar").click(function(){$(this).parent().slideUp(),$("#drop_zone").html("Arrastre AQUI un Archivo de EXCEL .XLS ó .XLSX"),$("#drop_zone").attr("style",""),$("#list").innerHTML=""})});var h=document.getElementById("drop_zone");h.addEventListener("dragover",d,!1),h.addEventListener("drop",b,!1);var i=function(a){a.preventDefault(),$("#drop_zone").css({border:"2px dashed green"})},j=function(a){a.preventDefault(),$("#drop_zone").css({border:"2px dashed #bbb"})};$("#drop_zone").on("dragenter",i).on("dragleave",j)}})});var sql,t,bind_events=function(){},exportar=function(){var a="data:application/xls;base64,",b='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',c=function(a){return window.btoa(unescape(encodeURIComponent(a)))},d=function(a,b){return a.replace(/{(\w+)}/g,function(a,c){return b[c]})};return function(e,f,g){e=document.getElementsByTagName("table")[0];var h=e.innerHTML,i=[];g=e.id,$(h).closest("thead").children().children().removeAttr("style").each(function(){i.push("<td>"+$(this).text()+"</td>")});var j="<thead><tr>"+i.join("")+"</tr></thead>"+document.getElementsByTagName("tbody")[0].innerHTML;console.log(j);var k={worksheet:f||"Worksheet",table:j},l=document.createElement("a");l.href=a+c(d(b,k)),l.download=g+".xls",l.innerHTML=g,document.body.appendChild(l),l.click(),document.body.removeChild(l)}}();