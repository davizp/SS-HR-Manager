// sanservices_absence - Last Update: Friday, December 19th, 2014, 1:37:27 PM CST
!function(a){a.fn.extend({tableExport:function(b){function c(a){return content_data="true"==d.htmlContent?a.html().trim():a.text().trim(),"true"==d.escape&&(content_data=content_data),content_data}var d={separator:",",ignoreColumn:[],tableName:"yourTableName",type:"csv",pdfFontSize:14,pdfLeftMargin:20,escape:"true",htmlContent:"false",consoleLog:"false"},b=a.extend(d,b),e=this;if("csv"==d.type||"txt"==d.type){var f="";a(e).find("thead").find("tr").each(function(){f+="\n",a(this).filter(":visible").find("th").each(function(b){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'"'+d.separator)}),f=a.trim(f),f=a.trim(f).substring(0,f.length-1)}),a(e).find("tbody").find("tr").each(function(){f+="\n",a(this).filter(":visible").find("td").each(function(b){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'"'+d.separator)}),f=a.trim(f).substring(0,f.length-1)}),"true"==d.consoleLog&&console.log(f);var g="base64,"+a.base64.encode(f);window.open("data:application/"+d.type+";filename=exportData;"+g)}else if("sql"==d.type){var f="INSERT INTO `"+d.tableName+"` (";a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+="`"+c(a(this))+"`,")}),f=a.trim(f),f=a.trim(f).substring(0,f.length-1)}),f+=") VALUES ",a(e).find("tbody").find("tr").each(function(){f+="(",a(this).filter(":visible").find("td").each(function(b){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(f+='"'+c(a(this))+'",')}),f=a.trim(f).substring(0,f.length-1),f+="),"}),f=a.trim(f).substring(0,f.length-1),f+=";","true"==d.consoleLog&&console.log(f);var g="base64,"+a.base64.encode(f);window.open("data:application/sql;filename=exportData;"+g)}else if("json"==d.type){var h=[];a(e).find("thead").find("tr").each(function(){var b=[];a(this).filter(":visible").find("th").each(function(e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&b.push(c(a(this)))}),h.push(b)});var i=[];a(e).find("tbody").find("tr").each(function(){var b=[];a(this).filter(":visible").find("td").each(function(e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&b.push(c(a(this)))}),i.push(b)});var j=[];j.push({header:h,data:i}),"true"==d.consoleLog&&console.log(JSON.stringify(j));var g="base64,"+a.base64.encode(JSON.stringify(j));window.open("data:application/json;filename=exportData;"+g)}else if("xml"==d.type){var k='<?xml version="1.0" encoding="utf-8"?>';k+="<tabledata><fields>",a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(k+="<field>"+c(a(this))+"</field>")})}),k+="</fields><data>";var l=1;a(e).find("tbody").find("tr").each(function(){k+='<row id="'+l+'">';var b=0;a(this).filter(":visible").find("td").each(function(e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&(k+="<column-"+b+">"+c(a(this))+"</column-"+b+">"),b++}),l++,k+="</row>"}),k+="</data></tabledata>","true"==d.consoleLog&&console.log(k);var g="base64,"+a.base64.encode(k);window.open("data:application/xml;filename=exportData;"+g)}else if("excel"==d.type||"doc"==d.type||"powerpoint"==d.type){var m="<table>";a(e).find("thead").find("tr").each(function(){m+="<tr>",a(this).filter(":visible").find("th").each(function(b){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)&&(m+="<td>"+c(a(this))+"</td>")}),m+="</tr>"});var l=1;a(e).find("tbody").find("tr").each(function(){m+="<tr>";var b=0;a(this).filter(":visible").find("td").each(function(e){"none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(e)&&(m+="<td>"+c(a(this))+"</td>"),b++}),l++,m+="</tr>"}),m+="</table>","true"==d.consoleLog&&console.log(m);var n="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:"+d.type+"' xmlns='http://www.w3.org/TR/REC-html40'>";n+="<head>",n+="<!--[if gte mso 9]>",n+="<xml>",n+="<x:ExcelWorkbook>",n+="<x:ExcelWorksheets>",n+="<x:ExcelWorksheet>",n+="<x:Name>",n+="{worksheet}",n+="</x:Name>",n+="<x:WorksheetOptions>",n+="<x:DisplayGridlines/>",n+="</x:WorksheetOptions>",n+="</x:ExcelWorksheet>",n+="</x:ExcelWorksheets>",n+="</x:ExcelWorkbook>",n+="</xml>",n+="<![endif]-->",n+="</head>",n+="<body>",n+=m,n+="</body>",n+="</html>",console.log(b.tableName);var g="base64,"+a.base64.encode(n),o=document.createElement("a");o.href="data:application/vnd.ms-excel;"+g,o.download=b.tableName+".xls",document.body.appendChild(o),o.click(),document.body.removeChild(o)}else if("png"==d.type)html2canvas(a(e),{onrendered:function(a){var b=a.toDataURL("image/png");window.open(b)}});else if("pdf"==d.type){var p=new jsPDF("p","pt","a4",!0);p.setFontSize(d.pdfFontSize);var q=d.pdfLeftMargin;a(e).find("thead").find("tr").each(function(){a(this).filter(":visible").find("th").each(function(b){if("none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)){var e=q+50*b;p.text(e,20,c(a(this)))}})});var r=20,s=1,t=0;a(e).find("tbody").find("tr").each(function(b){rowCalc=b+1,rowCalc%26==0&&(p.addPage(),s++,r+=10),t=r+10*rowCalc-280*(s-1),a(this).filter(":visible").find("td").each(function(b){if("none"!=a(this).css("display")&&-1==d.ignoreColumn.indexOf(b)){var e=q+50*b;p.text(e,t,c(a(this)))}})}),p.output("datauri")}}})}(jQuery);